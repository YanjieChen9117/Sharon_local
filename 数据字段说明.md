# NYC黄色出租车行程数据字段说明

## 数据集概览
- **文件名**: `yellow_tripdata_2025-01.parquet`
- **数据量**: 3,475,226 行 × 20 列
- **文件大小**: 56.42 MB
- **数据时间**: 2025年1月
- **数据来源**: NYC出租车与豪华轿车委员会 (TLC)

---

## 字段详细说明

### 1. VendorID (供应商ID)
- **数据类型**: int32
- **含义**: 提供行程记录的技术供应商
- **取值**:
  - 1 = Creative Mobile Technologies, LLC
  - 2 = VeriFone Inc.
- **用途**: 区分不同的数据采集系统，可用于分析不同供应商的数据质量

### 2. tpep_pickup_datetime (上车时间)
- **数据类型**: datetime64[us]
- **含义**: 计价器启动的日期和时间
- **格式**: YYYY-MM-DD HH:MM:SS
- **用途**: 
  - 时间序列分析
  - 高峰时段识别
  - 按小时/天/周分析出行模式

### 3. tpep_dropoff_datetime (下车时间)
- **数据类型**: datetime64[us]
- **含义**: 计价器关闭的日期和时间
- **格式**: YYYY-MM-DD HH:MM:SS
- **用途**:
  - 计算行程时长（dropoff - pickup）
  - 分析交通拥堵情况
  - 预测到达时间

### 4. passenger_count (乘客数量)
- **数据类型**: float64
- **含义**: 车内乘客数量（由司机输入）
- **取值范围**: 通常为 0-9
- **注意**: 可能存在空值(NaN)
- **用途**:
  - 分析拼车情况
  - 预测需求模式
  - 收入分析

### 5. trip_distance (行程距离)
- **数据类型**: float64
- **含义**: 计价器记录的行程距离
- **单位**: 英里(miles)
- **用途**:
  - 计算平均行程距离
  - 分析距离与费用关系
  - 路线优化
  - 异常值检测（过长或过短的行程）

### 6. RatecodeID (费率代码)
- **数据类型**: float64
- **含义**: 行程结束时生效的最终费率代码
- **取值**:
  - 1 = 标准费率
  - 2 = JFK机场
  - 3 = 纽瓦克机场
  - 4 = 拿骚或威斯切斯特郡
  - 5 = 协商费率
  - 6 = 团体乘车
- **用途**: 识别特殊费率行程，分析机场接送需求

### 7. store_and_fwd_flag (存储转发标志)
- **数据类型**: object (字符串)
- **含义**: 指示行程记录是否在发送到供应商之前存储在车辆内存中
- **取值**:
  - Y = 存储并转发的行程
  - N = 非存储并转发的行程
- **用途**: 判断车辆是否曾失去与服务器的连接

### 8. PULocationID (上车地点ID)
- **数据类型**: int32
- **含义**: 计价器启动的出租车区域
- **取值范围**: 1-263（NYC出租车区域代码）
- **用途**:
  - 热门上车地点分析
  - 地理空间可视化
  - 需求预测
  - 区域间流量分析

### 9. DOLocationID (下车地点ID)
- **数据类型**: int32
- **含义**: 计价器关闭的出租车区域
- **取值范围**: 1-263（NYC出租车区域代码）
- **用途**:
  - 热门目的地分析
  - OD（起点-终点）矩阵构建
  - 路线规划
  - 城市交通流量研究

### 10. payment_type (支付类型)
- **数据类型**: int64
- **含义**: 乘客支付行程的方式
- **取值**:
  - 1 = 信用卡
  - 2 = 现金
  - 3 = 免费
  - 4 = 争议
  - 5 = 未知
  - 6 = 作废行程
- **用途**:
  - 支付方式偏好分析
  - 小费行为研究（现金vs信用卡）

### 11. fare_amount (基本费用)
- **数据类型**: float64
- **含义**: 计价器计算的基本费用
- **单位**: 美元($)
- **包含**: 时间和距离费用
- **用途**:
  - 收入分析
  - 定价策略研究
  - 费用预测模型

### 12. extra (额外费用)
- **数据类型**: float64
- **含义**: 杂项额外费用和附加费
- **单位**: 美元($)
- **包含**: 
  - $0.50 高峰时段附加费（工作日6PM-10PM）
  - $1.00 夜间附加费（每天8PM-6AM）
- **用途**: 分析高峰和夜间出行

### 13. mta_tax (MTA税)
- **数据类型**: float64
- **含义**: 根据计价器费率自动触发的$0.50 MTA税
- **固定值**: 通常为 $0.50
- **用途**: 数据完整性验证

### 14. tip_amount (小费金额)
- **数据类型**: float64
- **含义**: 小费金额
- **单位**: 美元($)
- **注意**: 
  - 仅包含信用卡小费
  - 现金小费不包含在内
- **用途**:
  - 小费行为研究
  - 服务质量分析
  - 与行程特征的关联分析

### 15. tolls_amount (通行费)
- **数据类型**: float64
- **含义**: 行程中支付的所有通行费总额
- **单位**: 美元($)
- **用途**:
  - 路线选择分析
  - 成本计算
  - 桥梁/隧道使用模式

### 16. improvement_surcharge (改善附加费)
- **数据类型**: float64
- **含义**: 2015年起对上车的行程征收的$0.30附加费
- **固定值**: 通常为 $0.30
- **用途**: 总费用计算

### 17. total_amount (总金额)
- **数据类型**: float64
- **含义**: 向乘客收取的总金额
- **单位**: 美元($)
- **计算公式**: 
  ```
  total_amount = fare_amount + extra + mta_tax + tip_amount + 
                 tolls_amount + improvement_surcharge + 
                 congestion_surcharge + Airport_fee + cbd_congestion_fee
  ```
- **注意**: 不包括现金小费
- **用途**: 
  - 收入分析
  - 财务报告
  - 费用预测

### 18. congestion_surcharge (拥堵附加费)
- **数据类型**: float64
- **含义**: 在曼哈顿核心区（96街以南）上车的行程征收的拥堵附加费
- **取值**: 通常为 $2.50 或 $0
- **用途**: 
  - 拥堵定价政策分析
  - 地理区域分析

### 19. Airport_fee (机场费用)
- **数据类型**: float64
- **含义**: 仅适用于拉瓜迪亚、肯尼迪和纽瓦克机场上车或下车的行程
- **取值**: $1.25 或 $0
- **用途**: 识别机场行程，分析机场交通需求

### 20. cbd_congestion_fee (CBD拥堵费)
- **数据类型**: float64
- **含义**: 中央商务区拥堵费
- **取值**: 通常为 $0.75 或 $0，可能为负值（退款）
- **用途**: 
  - 拥堵定价效果评估
  - CBD区域行程分析

---

## 数据使用建议

### 1. 数据清洗
```python
# 移除异常值
df = df[df['trip_distance'] > 0]  # 距离必须大于0
df = df[df['fare_amount'] > 0]    # 费用必须大于0
df = df[df['passenger_count'] > 0]  # 乘客数必须大于0

# 移除极端值
df = df[df['trip_distance'] < 100]  # 距离小于100英里
df = df[df['total_amount'] < 500]   # 总费用小于500美元
```

### 2. 特征工程
```python
# 计算行程时长（分钟）
df['trip_duration'] = (df['tpep_dropoff_datetime'] - 
                       df['tpep_pickup_datetime']).dt.total_seconds() / 60

# 计算平均速度（英里/小时）
df['avg_speed'] = df['trip_distance'] / (df['trip_duration'] / 60)

# 提取时间特征
df['hour'] = df['tpep_pickup_datetime'].dt.hour
df['day_of_week'] = df['tpep_pickup_datetime'].dt.dayofweek
df['is_weekend'] = df['day_of_week'].isin([5, 6])

# 小费率
df['tip_rate'] = df['tip_amount'] / df['fare_amount']
```

### 3. 常见分析场景

#### 场景1: 高峰时段分析
```python
# 按小时分组，计算平均行程数
hourly_trips = df.groupby('hour').size()

# 识别高峰时段
peak_hours = hourly_trips.nlargest(5)
```

#### 场景2: 热门路线分析
```python
# 统计最常见的起点-终点对
popular_routes = df.groupby(['PULocationID', 'DOLocationID']).size()
top_routes = popular_routes.nlargest(10)
```

#### 场景3: 收入分析
```python
# 按日期计算总收入
daily_revenue = df.groupby(df['tpep_pickup_datetime'].dt.date)['total_amount'].sum()

# 计算平均每英里收入
df['revenue_per_mile'] = df['total_amount'] / df['trip_distance']
```

#### 场景4: 小费行为研究
```python
# 比较信用卡支付和现金支付的小费情况
tip_by_payment = df.groupby('payment_type')['tip_amount'].mean()

# 分析小费与行程特征的关系
import seaborn as sns
sns.scatterplot(data=df, x='trip_distance', y='tip_amount')
```

### 4. 数据可视化建议
- 使用热力图展示热门上下车地点
- 时间序列图展示出行模式
- 箱线图比较不同时段的费用分布
- 地理空间可视化（需要配合NYC区域边界数据）

### 5. 机器学习应用
- **回归**: 预测行程费用、行程时长
- **分类**: 预测支付方式、判断是否会给小费
- **聚类**: 发现相似的出行模式、区域分组
- **时间序列**: 预测未来需求、动态定价

---

## 注意事项

1. **数据质量**: 
   - 存在缺失值和异常值，使用前需要清洗
   - 部分记录可能有错误（如负费用、零距离等）

2. **隐私保护**:
   - 位置ID已经过脱敏处理，不包含具体GPS坐标
   - 无个人身份信息

3. **数据局限性**:
   - 现金小费未记录
   - 乘客数量由司机手动输入，可能不准确
   - 仅包含黄色出租车，不包含Uber/Lyft等

4. **时间范围**:
   - 本数据集仅包含2025年1月的数据
   - 进行时间序列分析时需要多个月的数据

---

## 相关资源

- [NYC TLC官方网站](https://www.nyc.gov/site/tlc/index.page)
- [出租车区域查询工具](https://data.cityofnewyork.us/Transportation/NYC-Taxi-Zones/d3c5-ddgc)
- [数据字典官方文档](https://www.nyc.gov/assets/tlc/downloads/pdf/data_dictionary_trip_records_yellow.pdf)

---

*最后更新: 2025年9月30日*

